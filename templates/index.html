{% extends "base.html" %}

{% block title %}Webhook Data Viewer - Home{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">
        <ul class="nav nav-tabs card-header-tabs" id="mainTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="senders-tab" data-bs-toggle="tab" data-bs-target="#senders" type="button" role="tab" aria-controls="senders" aria-selected="true">
                    <i class="fas fa-users me-1"></i>Senders
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="about-tab" data-bs-toggle="tab" data-bs-target="#about" type="button" role="tab" aria-controls="about" aria-selected="false">
                    <i class="fas fa-info-circle me-1"></i>About
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="api-tab" data-bs-toggle="tab" data-bs-target="#api" type="button" role="tab" aria-controls="api" aria-selected="false">
                    <i class="fas fa-code me-1"></i>API
                </button>
            </li>
        </ul>
    </div>
    <div class="card-body">
        <div class="tab-content" id="mainTabsContent">
            <div class="tab-pane fade show active" id="senders" role="tabpanel" aria-labelledby="senders-tab">
                <h2>Senders</h2>
                
                {% if senders %}
                <div class="row row-cols-1 row-cols-md-3 g-4 mt-3">
                    {% for sender in senders %}
                    <div class="col">
                        <div class="card h-100">
                            <div class="card-body">
                                <h5 class="card-title">
                                    <i class="fas fa-user me-2"></i>{{ sender }}
                                </h5>
                                <p class="card-text text-muted">View all submissions from this sender</p>
                            </div>
                            <div class="card-footer">
                                <a href="{{ url_for('view_sender', sender=sender) }}" class="btn btn-primary">
                                    <i class="fas fa-folder-open me-1"></i>Browse Data
                                </a>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div class="alert alert-info mt-4">
                    <i class="fas fa-info-circle me-2"></i>No data has been received yet. Send data to the webhook endpoint to see it here.
                </div>
                {% endif %}
            </div>
            
            <div class="tab-pane fade" id="about" role="tabpanel" aria-labelledby="about-tab">
                <h2>About this Application</h2>
                <div class="card bg-light mt-3">
                    <div class="card-body">
                        <h5 class="card-title">Webhook Data Viewer</h5>
                        <p class="card-text">
                            This application allows you to receive JSON data via a webhook endpoint
                            and view it in a human-readable format.
                        </p>
                        <h6 class="mt-4">Features:</h6>
                        <ul>
                            <li>Receive JSON data via webhook</li>
                            <li>Organize data by sender</li>
                            <li>Human-readable display</li>
                            <li>Tab-based navigation</li>
                            <li>Date-based organization</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="tab-pane fade" id="api" role="tabpanel" aria-labelledby="api-tab">
                <h2>API Documentation</h2>
                <div class="card bg-light mt-3">
                    <div class="card-body">
                        <h5 class="card-title">Webhook Endpoint</h5>
                        <p class="card-text">
                            To send data to this application, make a POST request to the webhook endpoint:
                        </p>
                        <div class="alert alert-secondary">
                            <code>POST /api/webhook</code>
                        </div>
                        
                        <h6 class="mt-4">Example Request:</h6>
<pre class="bg-dark text-light p-3">
curl -X POST \
  -H "Content-Type: application/json" \
  -d '{
    "sender": "example-user",
    "title": "Example Submission",
    "data": {
      "key1": "value1",
      "key2": "value2"
    }
  }' \
  {{ request.url_root }}api/webhook
</pre>

                        <h6 class="mt-4">Available API Endpoints:</h6>
                        <ul>
                            <li><code>GET /api/data</code> - List all senders</li>
                            <li><code>GET /api/data/&lt;sender&gt;</code> - List all submissions for a sender</li>
                            <li><code>GET /api/data/&lt;sender&gt;/&lt;submission_id&gt;</code> - Get a specific submission</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
